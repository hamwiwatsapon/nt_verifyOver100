"use strict";(()=>{var e={};e.id=978,e.ids=[978],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9491:e=>{e.exports=require("assert")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},6224:e=>{e.exports=require("tty")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},8686:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>x,originalPathname:()=>S,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>f});var a={};r.r(a),r.d(a,{POST:()=>c});var o=r(5419),s=r(9108),n=r(9678),i=r(8070),p=r(3567),u=r(7147),l=r.n(u);async function c(e){let t=await e.formData(),r=t.get("idCardNumber"),a=t.get("msisdn"),o="";null!==a&&(o=a.toString().replace(/^0+/,""));try{let e=`https://customerapi.cattelecom.com/app/customerapi/v200/search/customer/fetch?id_card_number=${r}&is_active=true`,t=(await p.Z.get(e,{headers:{apikey:process.env.PROD_API_KEY}})).data,s=JSON.stringify(t),n=function(){let e="",t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";for(let e=0;e<5;e++)t+=Math.floor(10*Math.random());for(let t=0;t<5;t++)e+=r.charAt(Math.floor(Math.random()*r.length));return{otp:t,reference:e,timestamp:Date.now()}}(),u=`OTP=${n.otp} [Ref: ${n.reference}] Please verify in 5 minutes`;if(t&&s.search(o)>=0){let e=new Date().toLocaleString().replace(/T/," ").replace(/\..+/,""),o=`${e}|${r}|CUSTOMER|${a}|SUCCESS
`;l().appendFile("./log/login.log",o,()=>{});let s=`<?xml version="1.0" encoding="utf-8"?>
      <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
          <soap:Body>
          <smssoap xmlns="http://microsoft.com/webservices/">
              <Username>rtcopr</Username>
              <Password>myRTC@brk</Password>
              <Sender>my</Sender>
              <Destination>${a}</Destination>
              <Message>${u}</Message>
              <Lang>T</Lang>
          </smssoap>
          </soap:Body>
      </soap:Envelope>`,c=await p.Z.post("http://10.100.75.4/motapi/smssoap.asmx?op=smssoap",s,{headers:{"Content-Type":"text/xml; charset: utf-8"}});if(200===c.status)return l().appendFile("./log/login.log",o,()=>{}),i.Z.json({status:200,otpData:n,customerData:t});return i.Z.json({status:401})}let c=new Date().toLocaleString().replace(/T/," ").replace(/\..+/,""),m=`${c}|${r}|CUSTOMER|${a}|INVALID MSISDN
`;return l().appendFile("./log/login.log",m,()=>{}),i.Z.json({status:401})}catch(o){let e=new Date().toLocaleString().replace(/T/," ").replace(/\..+/,""),t=`${e}|${r}|CUSTOMER|${a}|INVALID IDCARD
`;return l().appendFile("./log/login.log",t,()=>{}),i.Z.json({status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/customer/route",pathname:"/api/auth/customer",filename:"route",bundlePath:"app/api/auth/customer/route"},resolvedPagePath:"D:\\Billone\\NT\\nt_verifyOver100\\src\\app\\api\\auth\\customer\\route.tsx",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:g,headerHooks:x,staticGenerationBailout:f}=m,S="/api/auth/customer/route";function v(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,206,567],()=>r(8686));module.exports=a})();