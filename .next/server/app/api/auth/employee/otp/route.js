"use strict";(()=>{var e={};e.id=946,e.ids=[946],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9491:e=>{e.exports=require("assert")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},6224:e=>{e.exports=require("tty")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},3004:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>x,originalPathname:()=>v,patchFetch:()=>E,requestAsyncStorage:()=>d,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>f});var a={};r.r(a),r.d(a,{POST:()=>c});var o=r(5419),s=r(9108),p=r(9678),n=r(8070),i=r(3567),u=r(7147),l=r.n(u);async function c(e){let t=await e.formData(),r=t.get("msisdn"),a=t.get("EmployeeId"),o="";null!==r&&(o=r.toString().replace(/^0+/,""));try{let e=`https://customerapi.cattelecom.com/app/customerapi/v200/search/customer?subscriber_number=${o}&is_active=true`,t=(await i.Z.get(e,{headers:{apikey:process.env.PROD_API_KEY}})).data.customer_search[0].id_card_number,s=new Date().toLocaleString().replace(/T/," ").replace(/\..+/,""),p=`https://customerapi.cattelecom.com/app/customerapi/v200/search/customer/fetch?id_card_number=${t}&is_active=true`,u=(await i.Z.get(p,{headers:{apikey:process.env.PROD_API_KEY}})).data,c=function(){let e="",t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";for(let e=0;e<5;e++)t+=Math.floor(10*Math.random());for(let t=0;t<5;t++)e+=r.charAt(Math.floor(Math.random()*r.length));return{otp:t,reference:e,timestamp:Date.now()}}(),m=`OTP=${c.otp} [Ref: ${c.reference}] Please verify in 5 minutes`;if(u){let e=`<?xml version="1.0" encoding="utf-8"?>
        <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
            <soap:Body>
            <smssoap xmlns="http://microsoft.com/webservices/">
                <Username>rtcopr</Username>
                <Password>myRTC@brk</Password>
                <Sender>my</Sender>
                <Destination>${r}</Destination>
                <Message>${m}</Message>
                <Lang>T</Lang>
            </smssoap>
            </soap:Body>
        </soap:Envelope>`,t=await i.Z.post("http://10.100.75.4/motapi/smssoap.asmx?op=smssoap",e,{headers:{"Content-Type":"text/xml; charset: utf-8"}});if(200===t.status){let e=`${s}|${a}|EMPLOYEE|${r}|SUCCESS
`;return l().appendFile("./log/login.log",e,()=>{}),n.Z.json({status:200,otpData:c,customerData:u})}let o=`${s}|${a}|EMPLOYEE|${r}|INVALID
`;return l().appendFile("./log/login.log",o,()=>{}),n.Z.json({status:401})}let d=`${s}|${a}|EMPLOYEE|${r}|INVALID
`;return l().appendFile("./log/login.log",d,()=>{}),n.Z.json({status:401})}catch(o){let e=new Date().toLocaleString().replace(/T/," ").replace(/\..+/,""),t=`${e}|${a}|EMPLOYEE|${r}|ERROR
`;return l().appendFile("./log/login.log",t,()=>{}),n.Z.json({status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/employee/otp/route",pathname:"/api/auth/employee/otp",filename:"route",bundlePath:"app/api/auth/employee/otp/route"},resolvedPagePath:"D:\\Billone\\NT\\nt_verifyOver100\\src\\app\\api\\auth\\employee\\otp\\route.tsx",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:g,headerHooks:x,staticGenerationBailout:f}=m,v="/api/auth/employee/otp/route";function E(){return(0,p.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,206,567],()=>r(3004));module.exports=a})();