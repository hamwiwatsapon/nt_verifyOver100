(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[196],{3940:function(e,t,l){Promise.resolve().then(l.bind(l,8024))},8024:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return f}});var s=l(7437),a=l(2963),n=l(4510),r=l(1890),i=l(9625),o=l(2265),d=e=>{let{updateID:t,updateMsisdn:l,handleSubmit:a}=e;return(0,s.jsx)("form",{onSubmit:a,children:(0,s.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex w-full flex-wrap md:flex-nowrap mb-6 md:mb-0 gap-4 text-3xl",children:[(0,s.jsx)(r.Y,{type:"text",variant:"flat",label:"หมายเลขบัตรประชาชน",fullWidth:!0,isRequired:!0,radius:"md",size:"lg",maxLength:13,id:"cardnumber",onChange:t,required:!0}),(0,s.jsx)(r.Y,{type:"text",variant:"flat",label:"หมายเลขโทรศัพท์มือถือ",fullWidth:!0,isRequired:!0,radius:"md",size:"lg",maxLength:10,id:"msisdnd",onChange:l,required:!0})]},"flat"),(0,s.jsx)(i.A,{className:"text-3xl",type:"submit",color:"warning",fullWidth:!0,children:"รับรหัส OTP"})]})})},u=l(7485),c=l(3686),m=l(6540),x=l(7899),h=l(4033),f=()=>{(0,x.unstable_noStore)(),(0,h.useRouter)();let[e,t]=(0,o.useState)(""),[l,r]=(0,o.useState)(""),[i,f]=(0,o.useState)(!1),[p,w]=(0,o.useState)(!1),[j,g]=(0,o.useState)(""),[v,b]=o.useState(null),[y,N]=(0,o.useState)([]),k=async()=>{let t=new FormData;t.append("msisdn",e),t.append("idCardNumber",l),await fetch("/api/auth/customer",{method:"POST",body:t}).then(e=>e.json()).then(e=>{200===e.status?(b(e.otpData),f(!0),N(e.customerData.customer_search||[]),alert("Check your sms to verify otp.")):alert("Id card number or mobile number is invalid. ".concat(e.status))}).catch(e=>{console.error("Error:",e)})},S=async e=>{e.preventDefault(),await k()},C=async e=>{e.preventDefault(),null!==v&&j===v.otp&&(Date.now()-v.timestamp)/6e4<5?w(!0):null!==v&&(Date.now()-v.timestamp)/6e4>5?alert("รหัส OTP หมดอายุกรุณาคลิกส่ง OTP อีกครั้ง"):alert("รหัส OTP ไม่ถูกต้อง")};return(0,s.jsxs)(m.w,{children:[(0,s.jsx)("div",{className:"fixed top-20 right-20",children:(0,s.jsxs)(c.O,{size:"lg",isBlock:!0,href:"/",color:"foreground",children:[(0,s.jsxs)("svg",{className:"h-8 w-8 text-black",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",children:["  ",(0,s.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z"}),"  ",(0,s.jsx)("polyline",{points:"5 12 3 12 12 3 21 12 19 12"}),"  ",(0,s.jsx)("path",{d:"M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"}),"  ",(0,s.jsx)("path",{d:"M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"})]})," กลับหน้าหลัก"]})}),p?(0,s.jsx)("main",{className:"flex min-h-screen min-w-screen bg-gradient-to-tr from-yellow-100 via-yellow-400 to-yellow-500",children:(0,s.jsx)(u.Z,{data:y,msisdn:e})}):(0,s.jsx)("main",{className:"flex min-h-screen min-w-screen flex-col items-center justify-center p-24 bg-gradient-to-tr from-yellow-100 via-yellow-400 to-yellow-500",children:(0,s.jsxs)("div",{className:"z-10 max-w-10xl w-full items-center justify-between font-nt text-sm lg:flex flex-col",children:[(0,s.jsx)(a.Z,{}),(0,s.jsx)("h1",{className:"mb-10 text-3xl font-extrabold text-gray-900 md:text-4xl lg:text-5xl",children:" ระบบยืนยันตัวตนสำหรับผู้มีเบอร์โทรศัพท์หลายหมายเลข"}),(0,s.jsx)("div",{className:"min-w-screen",children:i?v&&(0,s.jsx)(n.Z,{genRef:v.reference,handleInputChange:(e,t)=>{let l=e.target.value;if(/^[0-9]$/.test(l)){let e=j.split("");e[t]=l,g(e.join(""))}console.log(j)},handleSubmit:C}):(0,s.jsx)(d,{updateID:e=>{r(e.target.value)},updateMsisdn:e=>{t(e.target.value)},handleSubmit:S})})]})})]})}}},function(e){e.O(0,[859,634,106,971,938,744],function(){return e(e.s=3940)}),_N_E=e.O()}]);