(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[487],{7580:function(e,t,s){Promise.resolve().then(s.bind(s,7198))},7198:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var a=s(7437),l=s(2963),n=s(4510),r=s(1890),i=s(9625),o=s(2265),c=e=>{let{updateEmployeeID:t,handleSubmit:s}=e;return(0,a.jsx)("form",{onSubmit:s,children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 max-w-5xl",children:[(0,a.jsx)("div",{className:"mb-6 md:mb-0 gap-4 text-sm ",children:(0,a.jsx)(r.Y,{type:"text",label:"หมายเลขประจำตัวพนักงาน",isRequired:!0,radius:"md",size:"lg",maxLength:10,id:"em",onChange:t,required:!0})},"flat"),(0,a.jsx)(i.A,{className:"text-3xl",type:"submit",color:"warning",children:"เข้าสู่ระบบ"})]})})},m=e=>{let{updateMsisdn:t,handleSubmit:s}=e;return(0,a.jsx)("form",{onSubmit:s,className:"justify-center items-center w-full",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 max-w-5xl",children:[(0,a.jsx)("div",{className:"mb-6 md:mb-0 text-sm ",children:(0,a.jsx)(r.Y,{type:"text",label:"หมายเลขโทรศัพท์",isRequired:!0,radius:"md",size:"lg",maxLength:10,id:"em",onChange:t,required:!0})},"flat"),(0,a.jsx)(i.A,{className:"text-3xl",type:"submit",color:"warning",children:"รับรหัส OTP"})]})})},d=s(7485),u=s(3686),x=s(6540),h=s(7899),f=s(4033),p=()=>{(0,h.unstable_noStore)(),(0,f.useRouter)();let[e,t]=(0,o.useState)(""),[s,r]=(0,o.useState)(""),[i,p]=(0,o.useState)(!1),[j,w]=(0,o.useState)(!1),[b,g]=(0,o.useState)(!1),[v,y]=(0,o.useState)(""),[N,S]=o.useState(null),[k,D]=(0,o.useState)([]),O=async()=>{let e=new FormData;e.append("EmployeeId",s),await fetch("/api/auth/employee",{method:"POST",body:e}).then(e=>e.json()).then(e=>{200===e.status&&g(!0)}).catch(e=>{console.error("Error:",e)})},_=async()=>{let t=new FormData;t.append("msisdn",e),await fetch("/api/msisdn",{method:"POST",body:t}).then(e=>e.json()).then(e=>{200===e.status?(S(e.otpData),p(!0),D(e.customerData.customer_search||[]),console.log(e.customerData.customer_search),alert("Check your sms to verify otp.")):alert("Id card number or mobile number is invalid. ".concat(e.status))}).catch(e=>{console.error("Error:",e)})},C=async e=>{e.preventDefault(),await O()},E=async e=>{e.preventDefault(),await _()},P=async e=>{e.preventDefault(),null!==N&&v===N.otp&&(Date.now()-N.timestamp)/6e4<5?w(!0):null!==N&&(Date.now()-N.timestamp)/6e4>5?alert("รหัส OTP หมดอายุกรุณาคลิกส่ง OTP อีกครั้ง"):alert("รหัส OTP ไม่ถูกต้อง")};return(0,a.jsxs)(x.w,{children:[(0,a.jsx)("div",{className:"fixed top-20 right-20",children:(0,a.jsxs)(u.O,{size:"lg",isBlock:!0,href:"/",color:"foreground",children:[(0,a.jsxs)("svg",{className:"h-8 w-8 text-black",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",children:["  ",(0,a.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z"}),"  ",(0,a.jsx)("polyline",{points:"5 12 3 12 12 3 21 12 19 12"}),"  ",(0,a.jsx)("path",{d:"M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"}),"  ",(0,a.jsx)("path",{d:"M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"})]})," กลับหน้าหลัก"]})}),j?(0,a.jsx)("main",{className:"flex min-h-screen min-w-screen",children:(0,a.jsx)(d.Z,{data:k,msisdn:e})}):(0,a.jsx)("main",{className:"flex min-h-screen min-w-screen flex-col items-center justify-center p-24 bg-gradient-to-tr from-yellow-100 via-yellow-400 to-yellow-500",children:(0,a.jsxs)("div",{className:"z-10 max-w-10xl w-full items-center justify-between font-nt text-sm lg:flex flex-col",children:[(0,a.jsx)(l.Z,{}),(0,a.jsx)("h1",{className:"mb-10 text-3xl font-extrabold text-gray-900 md:text-4xl lg:text-5xl",children:" ระบบยืนยันตัวตนสำหรับผู้มีเบอร์โทรศัพท์หลายหมายเลข"}),(0,a.jsx)("div",{className:"items-center",children:i?N&&(0,a.jsx)(n.Z,{genRef:N.reference,handleInputChange:(e,t)=>{let s=e.target.value;if(/^[0-9]$/.test(s)){let e=v.split("");e[t]=s,y(e.join(""))}},handleSubmit:P}):b?(0,a.jsx)(m,{updateMsisdn:e=>{t(e.target.value)},handleSubmit:E}):(0,a.jsx)(c,{updateEmployeeID:e=>{r(e.target.value)},handleSubmit:C})})]})})]})}}},function(e){e.O(0,[859,634,106,971,938,744],function(){return e(e.s=7580)}),_N_E=e.O()}]);